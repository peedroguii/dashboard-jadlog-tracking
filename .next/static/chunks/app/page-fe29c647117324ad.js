(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7665:(e,t,s)=>{Promise.resolve().then(s.bind(s,9342))},9342:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(5155),r=s(2115);function n(e){let{onUpload:t,compact:s=!1}=e,[n,o]=(0,r.useState)(!1),[l,i]=(0,r.useState)(null),c=async e=>{let s=e.target.files;if(s&&0!==s.length){o(!0),i(null);try{let a=await Promise.all(Array.from(s).map(e=>new Promise(t=>{let s=new FileReader;s.onload=e=>{var s;t(function(e){try{var t,s,a,r,n,o;let l=new DOMParser().parseFromString(e,"text/xml"),i=l.querySelector("parsererror");if(i)return console.error("Erro ao fazer parse do XML:",i.textContent),null;let c=l.querySelector("infCte"),d=(null==c?void 0:c.getAttribute("Id"))||"",u=(null==(t=l.querySelector("dest xNome"))?void 0:t.textContent)||"",m=(null==(s=l.querySelector("dest CPF"))?void 0:s.textContent)||"",x=(null==(a=l.querySelector("rem CNPJ"))?void 0:a.textContent)||"",h=((null==(r=l.querySelector("xObs"))?void 0:r.textContent)||"").match(/NUMERO OPERACIONAL:\s*(\d+)/),g=h?h[1]:"",p=(null==(n=l.querySelector("dhEmi"))?void 0:n.textContent)||"",f=(null==(o=l.querySelector("vTPrest"))?void 0:o.textContent)||"0",v=parseFloat(f);if(!u||!m||!x)return console.error("Campos obrigat\xf3rios n\xe3o encontrados no XML"),null;return{id:d,nomeDestinatario:u,cpfDestinatario:m,cnpjRemetente:x,numeroOperacional:g,dataEmissao:p,valorFrete:v}}catch(e){return console.error("Erro ao processar XML:",e),null}}(null==(s=e.target)?void 0:s.result))},s.onerror=()=>t(null),s.readAsText(e)}))).then(e=>e.filter(e=>null!==e));if(0===a.length)return void i("Nenhum arquivo XML v\xe1lido foi encontrado ou processado.");t(a),e.target.value=""}catch(e){i("Erro ao processar os arquivos XML. Verifique se os arquivos s\xe3o v\xe1lidos."),console.error("Erro no upload:",e)}finally{o(!1)}}};return s?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("label",{htmlFor:"xml-upload-compact",className:"cursor-pointer",children:(0,a.jsxs)("div",{className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),n?"Processando...":"Carregar XML"]})}),(0,a.jsx)("input",{id:"xml-upload-compact",type:"file",multiple:!0,accept:".xml,text/xml,application/xml",onChange:c,disabled:n,className:"hidden"}),l&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 text-red-600 text-xs bg-red-50 p-2 rounded-md",children:l})]}):(0,a.jsxs)("div",{className:"w-full max-w-md mx-auto",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border-2 border-dashed border-gray-300 p-6 text-center hover:border-gray-400 transition-colors",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"text-gray-600",children:(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,a.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"xml-upload",className:"cursor-pointer",children:[(0,a.jsx)("span",{className:"text-lg font-medium text-gray-900",children:"Carregar arquivos XML"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Selecione um ou mais arquivos XML da Jadlog"})]}),(0,a.jsx)("input",{id:"xml-upload",type:"file",multiple:!0,accept:".xml,text/xml,application/xml",onChange:c,disabled:n,className:"hidden"})]}),n&&(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-900"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Processando arquivos..."})]}),l&&(0,a.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:l})]})}),(0,a.jsxs)("div",{className:"mt-4 text-xs text-gray-500 text-center",children:[(0,a.jsx)("p",{children:"Formatos aceitos: XML"}),(0,a.jsx)("p",{children:"M\xfaltiplos arquivos podem ser selecionados"})]})]})}class o{async consultarTracking(e){try{let t=await fetch("".concat(this.baseURL,"/consultar"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.token)},body:JSON.stringify({consulta:[{codigo:e}]})});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}catch(e){return console.error("Erro ao consultar tracking:",e),null}}async consultarTrackingSimples(e){try{let t=await fetch("".concat(this.baseURL,"/simples/consultar"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.token)},body:JSON.stringify({consulta:e.map(e=>({codigo:e}))})});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}catch(e){return console.error("Erro ao consultar tracking simples:",e),null}}constructor(e){this.baseURL="https://prd-traffic.jadlogtech.com.br/embarcador/api/tracking",this.token=e}}var l=s(9509);function i(e){let{remessas:t,onClear:s,onUpdateRemessa:n,filtroAtivo:i}=e,[c,d]=(0,r.useState)(""),[u,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)({current:0,total:0});if(0===t.length)return null;let g=e=>11===e.length?e.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"):e,p=e=>14===e.length?e.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"):e,f=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("pt-BR")}catch(t){return e}},v=async()=>{if(u)return;let e=t.map((e,t)=>({remessa:e,index:t})).filter(e=>{let{remessa:t}=e;return t.numeroOperacional&&""!==t.numeroOperacional.trim()});if(0===e.length)return void alert("Nenhuma remessa com n\xfamero operacional encontrada para atualizar.");if(confirm("Deseja atualizar o status de ".concat(e.length," remessa").concat(e.length>1?"s":"","?\n\n")+"Esta opera\xe7\xe3o pode levar alguns minutos devido aos limites da API da Jadlog.")){m(!0),h({current:0,total:e.length});try{let t=e.map(e=>{let{remessa:t}=e;return t.numeroOperacional}),s=new o(l.env.JADLOG_API_KEY||""),a=await s.consultarTrackingSimples(t);if(!a)throw Error("Resposta inv\xe1lida da API");if(console.log(a),a.consulta&&a.consulta[0]&&a.consulta[0].tracking){let e=a.consulta[0].tracking,t={status:e.status||"N\xe3o dispon\xedvel",ultimaAtualizacao:e.dtEmissao||new Date().toLocaleDateString("pt-BR"),previsaoEntrega:a.consulta[0].previsaoEntrega,eventos:e.eventos||[]};console.log(t);return}throw Error("Resposta inv\xe1lida da API")}catch(e){console.error("Erro ao atualizar todos:",e),alert("Erro ao atualizar remessas. Tente novamente mais tarde.")}finally{m(!1),h({current:0,total:0})}}},j=async(e,t)=>{if(!e.numeroOperacional)return void alert("N\xfamero operacional n\xe3o encontrado para esta remessa");n(t,{...e,isLoadingTracking:!0});try{let s=await fetch("/api/tracking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({numeroOperacional:e.numeroOperacional})});if(!s.ok)throw Error("Erro ao consultar tracking");let a=await s.json();if(a.consulta&&a.consulta[0]&&a.consulta[0].tracking){let s=a.consulta[0].tracking,r={status:s.status||"N\xe3o dispon\xedvel",ultimaAtualizacao:s.dtEmissao||new Date().toLocaleDateString("pt-BR"),previsaoEntrega:a.consulta[0].previsaoEntrega,eventos:s.eventos||[]};n(t,{...e,tracking:r,isLoadingTracking:!1})}else n(t,{...e,tracking:{status:"N\xe3o encontrado",ultimaAtualizacao:"N/A",eventos:[]},isLoadingTracking:!1})}catch(s){console.error("Erro ao consultar tracking:",s),n(t,{...e,tracking:{status:"Erro na consulta",ultimaAtualizacao:"N/A",eventos:[]},isLoadingTracking:!1})}},b=e=>{if(e.isLoadingTracking)return(0,a.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-gray-600 mr-1"}),"Consultando..."]});if(!e.tracking)return(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Clique para consultar"});let t=e.tracking.status.toLowerCase();return t.includes("entregue")||t.includes("entrega")?(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:e.tracking.status}):t.includes("transito")||t.includes("tr\xe2nsito")?(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:e.tracking.status}):t.includes("problema")||t.includes("erro")?(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:e.tracking.status}):(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:e.tracking.status})},N=e=>{if(!i)return!0;switch(i){case"emTransito":return e.tracking&&(e.tracking.status.toLowerCase().includes("transito")||e.tracking.status.toLowerCase().includes("tr\xe2nsito"));case"entregue":return e.tracking&&(e.tracking.status.toLowerCase().includes("entregue")||e.tracking.status.toLowerCase().includes("entrega"));case"comProblemas":return e.tracking&&(e.tracking.status.toLowerCase().includes("problema")||e.tracking.status.toLowerCase().includes("erro"));default:return!0}},y=t.filter(e=>{if(!N(e))return!1;if(!c)return!0;let t=c.toLowerCase().trim(),s=c.replace(/\D/g,""),a=e.nomeDestinatario.toLowerCase().includes(t),r=s.length>0&&(e.cpfDestinatario.includes(s)||g(e.cpfDestinatario).includes(c));return a||r}),w=new Date,k=t.filter(e=>{var t;if(null==(t=e.tracking)?void 0:t.status.toLowerCase().includes("entregue")){let t=new Date(e.tracking.ultimaAtualizacao),s=Math.floor((w.getTime()-t.getTime())/864e5);return s>=5&&s<=7}return!1}).length;return(0,a.jsxs)("div",{className:"w-full max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Detalhes das Encomendas"}),k>0&&(0,a.jsxs)("div",{className:"text-sm text-amber-600 bg-amber-50 px-3 py-1 rounded-full",children:["⚠️ ",k," remessa",k>1?"s":""," ser\xe1",k>1?"\xe3o":""," removida",k>1?"s":""," em breve"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,a.jsx)("input",{type:"text",placeholder:"Pesquisar por nome ou CPF do destinat\xe1rio...",value:c,onChange:e=>d(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:v,disabled:u||0===t.length,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Atualizando... (",x.current,"/",x.total,")"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Atualizar Todos"]})}),(0,a.jsxs)("button",{onClick:s,className:"px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 flex items-center",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Limpar Tudo"]})]})]})]}),(0,a.jsx)("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome do Cliente"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CPF"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CNPJ Remetente"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"N\xba Operacional"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\xdaltima Atualiza\xe7\xe3o"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===y.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:i?'Nenhuma remessa encontrada com o filtro "'.concat(i,'" aplicado.'):c?"Nenhuma remessa encontrada com os crit\xe9rios de pesquisa.":"Nenhuma remessa encontrada."})}):y.map((e,t)=>{var s;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.nomeDestinatario})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900 font-mono",children:g(e.cpfDestinatario)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900 font-mono",children:p(e.cnpjRemetente)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900 font-mono",children:e.numeroOperacional||"-"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:b(e)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:(null==(s=e.tracking)?void 0:s.ultimaAtualizacao)||f(e.dataEmissao||"")})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,a.jsx)("button",{onClick:()=>j(e,t),disabled:e.isLoadingTracking,className:"text-blue-600 hover:text-blue-900 disabled:opacity-50 disabled:cursor-not-allowed",children:e.isLoadingTracking?"Consultando...":"Consultar"})})]},e.id||t)})})]})})}),(0,a.jsxs)("div",{className:"mt-6 flex justify-between items-center text-sm text-gray-500",children:[(0,a.jsxs)("p",{children:["Mostrando ",y.length," de ",t.length," remessa",1!==t.length?"s":"",i&&(0,a.jsxs)("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:["Filtro: ","emTransito"===i?"Em Tr\xe2nsito":"entregue"===i?"Entregue":"comProblemas"===i?"Com Problemas":i]})]}),(0,a.jsx)("p",{children:"\uD83D\uDCBE Dados salvos localmente - Remessas entregues s\xe3o removidas ap\xf3s 7 dias"})]})]})}function c(e){var t;let{remessas:s,filtroAtivo:r,onFiltroChange:n}=e,o=new Date,l=0,i=s.reduce((e,t)=>{var s,a,r;if(null==(s=t.tracking)?void 0:s.status.toLowerCase().includes("entregue")){let s=new Date(t.tracking.ultimaAtualizacao),a=Math.floor((o.getTime()-s.getTime())/864e5);a>=5&&a<=7&&l++,e.entregue++}else(null==(a=t.tracking)?void 0:a.status.toLowerCase().includes("problema"))||(null==(r=t.tracking)?void 0:r.status.toLowerCase().includes("erro"))?e.comProblemas++:t.tracking?e.emTransito++:e.pendentes=(e.pendentes||0)+1;return e},{emTransito:0,entregue:0,comProblemas:0,pendentes:0}),c=e=>{r===e?n(null):n(e)},d=[{id:"emTransito",title:"Em Tr\xe2nsito",value:i.emTransito,subtitle:"Remessas em movimento",icon:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),color:"bg-blue-500",bgColor:"bg-blue-50",textColor:"text-blue-600",hoverColor:"hover:bg-blue-100",activeColor:"ring-blue-500"},{id:"entregue",title:"Entregue",value:i.entregue,subtitle:l>0?"".concat(l," expira(m) em breve"):"Entregas conclu\xeddas",icon:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),color:"bg-green-500",bgColor:"bg-green-50",textColor:"text-green-600",hoverColor:"hover:bg-green-100",activeColor:"ring-green-500"},{id:"comProblemas",title:"Com Problemas",value:i.comProblemas,subtitle:"Requer aten\xe7\xe3o",icon:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})}),color:"bg-red-500",bgColor:"bg-red-50",textColor:"text-red-600",hoverColor:"hover:bg-red-100",activeColor:"ring-red-500"}];return(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:d.map(e=>{let t=r===e.id;return(0,a.jsxs)("div",{onClick:()=>c(e.id),className:"\n                ".concat(e.bgColor," rounded-lg p-6 cursor-pointer transition-all duration-200 \n                ").concat(e.hoverColor," transform hover:scale-105 hover:shadow-md\n                ").concat(t?"ring-2 ".concat(e.activeColor," shadow-lg scale-105"):"","\n              "),children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-3 rounded-lg ".concat(e.color),children:(0,a.jsx)("div",{className:"text-white",children:e.icon})}),(0,a.jsxs)("div",{className:"ml-4 flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:e.title}),t&&(0,a.jsx)("div",{className:"text-xs bg-white px-2 py-1 rounded-full text-gray-600 font-medium",children:"Filtro ativo"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.value}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.subtitle})]})]}),(0,a.jsxs)("div",{className:"mt-3 text-xs text-gray-400 flex items-center",children:[(0,a.jsxs)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Clique para filtrar"]})]},e.id)})}),r&&(0,a.jsx)("div",{className:"mt-4 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white px-4 py-2 rounded-full shadow-sm border flex items-center space-x-2",children:[(0,a.jsx)("svg",{className:"w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"})}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["Filtro ativo: ",(0,a.jsx)("strong",{children:null==(t=d.find(e=>e.id===r))?void 0:t.title})]}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),n(null)},className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]})}let d="jadlog_remessas";function u(){let{remessas:e,isLoading:t,adicionarRemessas:s,atualizarRemessa:o,limparRemessas:l,limparRemessasAntigas:u,obterEstatisticas:m}=function(){let[e,t]=(0,r.useState)([]),[s,a]=(0,r.useState)(!0);(0,r.useEffect)(()=>{try{let e=localStorage.getItem(d);if(e){let s=JSON.parse(e),a=new Date,r=s.filter(e=>{var t;if(null==(t=e.tracking)?void 0:t.status.toLowerCase().includes("entregue")){let t=new Date(e.tracking.ultimaAtualizacao);return 7>=Math.floor((a.getTime()-t.getTime())/864e5)}return!0});r.length!==s.length&&localStorage.setItem(d,JSON.stringify(r)),t(r)}}catch(e){console.error("Erro ao carregar remessas do localStorage:",e)}finally{a(!1)}},[]);let n=e=>{try{localStorage.setItem(d,JSON.stringify(e)),t(e)}catch(e){console.error("Erro ao salvar remessas no localStorage:",e)}};return{remessas:e,isLoading:s,adicionarRemessas:t=>{let s=[...e];t.forEach(e=>{s.some(t=>t.numeroOperacional===e.numeroOperacional)||s.push(e)}),n(s)},atualizarRemessa:(t,s)=>{let a=[...e];a[t]=s,n(a)},limparRemessas:()=>{try{localStorage.removeItem(d),t([])}catch(e){console.error("Erro ao limpar remessas:",e)}},limparRemessasAntigas:()=>{let t=new Date,s=e.filter(e=>{var s;if(null==(s=e.tracking)?void 0:s.status.toLowerCase().includes("entregue")){let s=new Date(e.tracking.ultimaAtualizacao);return 7>=Math.floor((t.getTime()-s.getTime())/864e5)}return!0});return n(s),e.length-s.length},obterEstatisticas:()=>{let t=new Date,s=0;return{...e.reduce((e,a)=>{var r,n,o;if(null==(r=a.tracking)?void 0:r.status.toLowerCase().includes("entregue")){let r=new Date(a.tracking.ultimaAtualizacao);Math.floor((t.getTime()-r.getTime())/864e5)>=5&&s++,e.entregue++}else(null==(n=a.tracking)?void 0:n.status.toLowerCase().includes("problema"))||(null==(o=a.tracking)?void 0:o.status.toLowerCase().includes("erro"))?e.comProblemas++:e.emTransito++;return e},{emTransito:0,entregue:0,comProblemas:0}),proximasAExpirar:s}}}}(),[x,h]=(0,r.useState)(null),g=e=>{s(e)};return t?(0,a.jsx)("main",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Carregando remessas salvas..."})]})}):(0,a.jsx)("main",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center mr-3",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard de Rastreamento Jadlog"})]}),e.length>0&&(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{let e=u();e>0?alert("".concat(e," remessa").concat(e>1?"s":""," entregue").concat(e>1?"s":""," h\xe1 mais de 7 dias foi").concat(e>1?"ram":""," removida").concat(e>1?"s":""," do dashboard.")):alert("Nenhuma remessa antiga foi encontrada para remo\xe7\xe3o.")},className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Limpar Antigas"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 self-center",children:["Total: ",e.length," remessas"]})]})]}),0===e.length&&(0,a.jsxs)("div",{className:"mb-12",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Importe seus arquivos XML"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Carregue os arquivos XML da Jadlog para visualizar as informa\xe7\xf5es das remessas"}),(0,a.jsx)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,a.jsx)("strong",{children:"\uD83D\uDCBE Banco de Dados Local:"})," Suas remessas ficam salvas no navegador. Remessas entregues s\xe3o automaticamente removidas ap\xf3s 7 dias."]})})]}),(0,a.jsx)(n,{onUpload:g})]}),e.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c,{remessas:e,filtroAtivo:x,onFiltroChange:h}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Adicionar mais remessas"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Carregue arquivos XML adicionais - duplicatas s\xe3o ignoradas automaticamente"})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(n,{onUpload:g,compact:!0})})]})})}),(0,a.jsx)(i,{remessas:e,onClear:()=>{window.confirm("⚠️ ATEN\xc7\xc3O: Esta a\xe7\xe3o ir\xe1 remover TODAS as remessas permanentemente!\n\nVoc\xea tem certeza que deseja continuar?\n\nEsta a\xe7\xe3o n\xe3o pode ser desfeita.")&&window.confirm("\uD83D\uDEA8 CONFIRMA\xc7\xc3O FINAL\n\nVoc\xea est\xe1 prestes a apagar TODAS as remessas do sistema.\n\nClique em OK para confirmar a exclus\xe3o definitiva.")&&(l(),h(null))},onUpdateRemessa:(e,t)=>{o(e,t)},filtroAtivo:x})]}),0===e.length&&(0,a.jsx)("div",{className:"max-w-3xl mx-auto mt-16",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Como usar esta ferramenta"}),(0,a.jsxs)("div",{className:"space-y-4 text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:"1"}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Selecione os arquivos XML:"})," Clique no bot\xe3o de upload acima e selecione um ou mais arquivos XML fornecidos pela Jadlog. Os dados ficam salvos permanentemente."]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:"2"}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Consulte o tracking:"}),' Clique em "Consultar" para obter o status atualizado via API da Jadlog. O status fica salvo e atualiza as estat\xedsticas.']})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:"3"}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Limpeza autom\xe1tica:"}),' Remessas entregues s\xe3o automaticamente removidas ap\xf3s 7 dias. Use "Limpar Antigas" para for\xe7ar a limpeza.']})]})]})]})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(7665)),_N_E=e.O()}]);