(()=>{var e={};e.id=484,e.ids=[484],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6487:()=>{},7545:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>h,routeModule:()=>u,serverHooks:()=>d,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>l});var s={};t.r(s),t.d(s,{POST:()=>c});var a=t(6559),o=t(8088),n=t(7719),i=t(2190);async function c(e){try{let{numeroOperacionais:r}=await e.json();if(!r||!Array.isArray(r))return i.NextResponse.json({error:"Lista de n\xfameros operacionais \xe9 obrigat\xf3ria"},{status:400});if(0===r.length)return i.NextResponse.json({results:[]});let t=[];for(let e=0;e<r.length;e+=100)t.push(r.slice(e,e+100));let s=[],a=0;for(let e=0;e<t.length;e++){let r=t[e];try{let o=r.map(e=>({pedido:e})),n=await fetch("https://prd-traffic.jadlogtech.com.br/embarcador/api/tracking/simples/consultar",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${process.env.JADLOG_API_TOKEN||"demo-token"}`},body:JSON.stringify({consulta:o})});if(n.ok){let e=await n.json();e.consulta&&Array.isArray(e.consulta)?e.consulta.forEach((e,t)=>{let a=r[t];e.tracking?s.push({numeroOperacional:a,success:!0,tracking:{status:e.tracking.status||"N\xe3o dispon\xedvel",ultimaAtualizacao:e.tracking.dtEmissao||new Date().toLocaleDateString("pt-BR"),previsaoEntrega:e.previsaoEntrega,eventos:e.tracking.eventos||[]}}):s.push({numeroOperacional:a,success:!1,error:"Tracking n\xe3o encontrado"})}):r.forEach(e=>{s.push({numeroOperacional:e,success:!1,error:"Resposta inv\xe1lida da API"})})}else console.error(`Erro na API Jadlog para lote ${e+1}:`,n.status),r.forEach(e=>{s.push({numeroOperacional:e,success:!1,error:`Erro HTTP ${n.status}`})});a+=r.length,e<t.length-1&&await new Promise(e=>setTimeout(e,2e3))}catch(t){console.error(`Erro ao processar lote ${e+1}:`,t),r.forEach(e=>{s.push({numeroOperacional:e,success:!1,error:"Erro de conex\xe3o"})})}}return i.NextResponse.json({results:s,summary:{total:r.length,processed:a,successful:s.filter(e=>e.success).length,failed:s.filter(e=>!e.success).length,batches:t.length}})}catch(e){return console.error("Erro na API de consulta em lote:",e),i.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/tracking/batch/route",pathname:"/api/tracking/batch",filename:"route",bundlePath:"app/api/tracking/batch/route"},resolvedPagePath:"C:\\Users\\andre\\Desktop\\Nova pasta\\dashboard-jadlog-tracking\\src\\app\\api\\tracking\\batch\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:p,workUnitAsyncStorage:l,serverHooks:d}=u;function h(){return(0,n.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:l})}},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[447,580],()=>t(7545));module.exports=s})();