(()=>{var e={};e.id=974,e.ids=[974],e.modules={555:()=>{},826:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var r=s(687),a=s(3210);function n({onUpload:e,compact:t=!1}){let[s,n]=(0,a.useState)(!1),[o,i]=(0,a.useState)(null),l=async t=>{let s=t.target.files;if(s&&0!==s.length){n(!0),i(null);try{let r=await Promise.all(Array.from(s).map(e=>new Promise(t=>{let s=new FileReader;s.onload=e=>{t(function(e){try{let t=new DOMParser().parseFromString(e,"text/xml"),s=t.querySelector("parsererror");if(s)return console.error("Erro ao fazer parse do XML:",s.textContent),null;let r=t.querySelector("infCte"),a=r?.getAttribute("Id")||"",n=t.querySelector("dest xNome")?.textContent||"",o=t.querySelector("dest CPF")?.textContent||"",i=t.querySelector("rem CNPJ")?.textContent||"",l=(t.querySelector("xObs")?.textContent||"").match(/NUMERO OPERACIONAL:\s*(\d+)/),d=l?l[1]:"",c=t.querySelector("dhEmi")?.textContent||"",m=t.querySelector("vTPrest")?.textContent||"0",u=parseFloat(m);if(!n||!o||!i)return console.error("Campos obrigat\xf3rios n\xe3o encontrados no XML"),null;return{id:a,nomeDestinatario:n,cpfDestinatario:o,cnpjRemetente:i,numeroOperacional:d,dataEmissao:c,valorFrete:u}}catch(e){return console.error("Erro ao processar XML:",e),null}}(e.target?.result))},s.onerror=()=>t(null),s.readAsText(e)}))).then(e=>e.filter(e=>null!==e));if(0===r.length)return void i("Nenhum arquivo XML v\xe1lido foi encontrado ou processado.");e(r),t.target.value=""}catch(e){i("Erro ao processar os arquivos XML. Verifique se os arquivos s\xe3o v\xe1lidos."),console.error("Erro no upload:",e)}finally{n(!1)}}};return t?(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{htmlFor:"xml-upload-compact",className:"cursor-pointer",children:(0,r.jsxs)("div",{className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),s?"Processando...":"Carregar XML"]})}),(0,r.jsx)("input",{id:"xml-upload-compact",type:"file",multiple:!0,accept:".xml,text/xml,application/xml",onChange:l,disabled:s,className:"hidden"}),o&&(0,r.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 text-red-600 text-xs bg-red-50 p-2 rounded-md",children:o})]}):(0,r.jsxs)("div",{className:"w-full max-w-md mx-auto",children:[(0,r.jsx)("div",{className:"bg-white rounded-lg border-2 border-dashed border-gray-300 p-6 text-center hover:border-gray-400 transition-colors",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"text-gray-600",children:(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,r.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"xml-upload",className:"cursor-pointer",children:[(0,r.jsx)("span",{className:"text-lg font-medium text-gray-900",children:"Carregar arquivos XML"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Selecione um ou mais arquivos XML da Jadlog"})]}),(0,r.jsx)("input",{id:"xml-upload",type:"file",multiple:!0,accept:".xml,text/xml,application/xml",onChange:l,disabled:s,className:"hidden"})]}),s&&(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-900"}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Processando arquivos..."})]}),o&&(0,r.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:o})]})}),(0,r.jsxs)("div",{className:"mt-4 text-xs text-gray-500 text-center",children:[(0,r.jsx)("p",{children:"Formatos aceitos: XML"}),(0,r.jsx)("p",{children:"M\xfaltiplos arquivos podem ser selecionados"})]})]})}function o({remessas:e,onClear:t,onUpdateRemessa:s,filtroAtivo:n}){let[o,i]=(0,a.useState)(""),[l,d]=(0,a.useState)(!1),[c,m]=(0,a.useState)({current:0,total:0});if(0===e.length)return null;let u=e=>11===e.length?e.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"):e,x=e=>14===e.length?e.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"):e,h=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("pt-BR")}catch{return e}},p=async()=>{if(l)return;let t=e.map((e,t)=>({remessa:e,index:t})).filter(({remessa:e})=>e.numeroOperacional&&""!==e.numeroOperacional.trim());if(0===t.length)return void alert("Nenhuma remessa com n\xfamero operacional encontrada para atualizar.");if(confirm(`Deseja atualizar o status de ${t.length} remessa${t.length>1?"s":""}?

Esta opera\xe7\xe3o pode levar alguns minutos devido aos limites da API da Jadlog.`)){d(!0),m({current:0,total:t.length});try{let e=t.map(({remessa:e})=>e.numeroOperacional),r=await fetch("/api/tracking/batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({numeroOperacionais:e})});if(!r.ok)throw Error(`Erro HTTP: ${r.status}`);let a=await r.json();if(a.results&&Array.isArray(a.results)){a.results.forEach(e=>{let r=t.find(({remessa:t})=>t.numeroOperacional===e.numeroOperacional);if(r){let{remessa:t,index:a}=r;e.success&&e.tracking?s(a,{...t,tracking:{status:e.tracking.status,ultimaAtualizacao:e.tracking.ultimaAtualizacao,previsaoEntrega:e.tracking.previsaoEntrega,eventos:e.tracking.eventos||[]},isLoadingTracking:!1}):s(a,{...t,tracking:{status:e.error||"Erro na consulta",ultimaAtualizacao:"N/A",eventos:[]},isLoadingTracking:!1})}});let{summary:e}=a;alert(`Atualiza\xe7\xe3o conclu\xedda!

Total processado: ${e.processed}
Sucessos: ${e.successful}
Falhas: ${e.failed}
Lotes processados: ${e.batches}`)}else throw Error("Resposta inv\xe1lida da API")}catch(e){console.error("Erro ao atualizar todos:",e),alert("Erro ao atualizar remessas. Tente novamente mais tarde.")}finally{d(!1),m({current:0,total:0})}}},g=async(e,t)=>{if(!e.numeroOperacional)return void alert("N\xfamero operacional n\xe3o encontrado para esta remessa");s(t,{...e,isLoadingTracking:!0});try{let r=await fetch("/api/tracking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({numeroOperacional:e.numeroOperacional})});if(!r.ok)throw Error("Erro ao consultar tracking");let a=await r.json();if(a.consulta&&a.consulta[0]&&a.consulta[0].tracking){let r=a.consulta[0].tracking,n={status:r.status||"N\xe3o dispon\xedvel",ultimaAtualizacao:r.dtEmissao||new Date().toLocaleDateString("pt-BR"),previsaoEntrega:a.consulta[0].previsaoEntrega,eventos:r.eventos||[]};s(t,{...e,tracking:n,isLoadingTracking:!1})}else s(t,{...e,tracking:{status:"N\xe3o encontrado",ultimaAtualizacao:"N/A",eventos:[]},isLoadingTracking:!1})}catch(r){console.error("Erro ao consultar tracking:",r),s(t,{...e,tracking:{status:"Erro na consulta",ultimaAtualizacao:"N/A",eventos:[]},isLoadingTracking:!1})}},f=e=>{if(e.isLoadingTracking)return(0,r.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-gray-600 mr-1"}),"Consultando..."]});if(!e.tracking)return(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Clique para consultar"});let t=e.tracking.status.toLowerCase();return t.includes("entregue")||t.includes("entrega")?(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:e.tracking.status}):t.includes("transito")||t.includes("tr\xe2nsito")?(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:e.tracking.status}):t.includes("problema")||t.includes("erro")?(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:e.tracking.status}):(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:e.tracking.status})},v=e=>{if(!n)return!0;switch(n){case"emTransito":return e.tracking&&(e.tracking.status.toLowerCase().includes("transito")||e.tracking.status.toLowerCase().includes("tr\xe2nsito"));case"entregue":return e.tracking&&(e.tracking.status.toLowerCase().includes("entregue")||e.tracking.status.toLowerCase().includes("entrega"));case"comProblemas":return e.tracking&&(e.tracking.status.toLowerCase().includes("problema")||e.tracking.status.toLowerCase().includes("erro"));default:return!0}},b=e.filter(e=>{if(!v(e))return!1;if(!o)return!0;let t=o.toLowerCase().trim(),s=o.replace(/\D/g,""),r=e.nomeDestinatario.toLowerCase().includes(t),a=s.length>0&&(e.cpfDestinatario.includes(s)||u(e.cpfDestinatario).includes(o));return r||a}),j=new Date,N=e.filter(e=>{if(e.tracking?.status.toLowerCase().includes("entregue")){let t=new Date(e.tracking.ultimaAtualizacao),s=Math.floor((j.getTime()-t.getTime())/864e5);return s>=5&&s<=7}return!1}).length;return(0,r.jsxs)("div",{className:"w-full max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Detalhes das Encomendas"}),N>0&&(0,r.jsxs)("div",{className:"text-sm text-amber-600 bg-amber-50 px-3 py-1 rounded-full",children:["⚠️ ",N," remessa",N>1?"s":""," ser\xe1",N>1?"\xe3o":""," removida",N>1?"s":""," em breve"]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,r.jsx)("input",{type:"text",placeholder:"Pesquisar por nome ou CPF do destinat\xe1rio...",value:o,onChange:e=>i(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:p,disabled:l||0===e.length,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Atualizando... (",c.current,"/",c.total,")"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Atualizar Todos"]})}),(0,r.jsxs)("button",{onClick:t,className:"px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 flex items-center",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Limpar Tudo"]})]})]})]}),(0,r.jsx)("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome do Cliente"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CPF"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CNPJ Remetente"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"N\xba Operacional"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\xdaltima Atualiza\xe7\xe3o"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===b.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:n?`Nenhuma remessa encontrada com o filtro "${n}" aplicado.`:o?"Nenhuma remessa encontrada com os crit\xe9rios de pesquisa.":"Nenhuma remessa encontrada."})}):b.map((e,t)=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.nomeDestinatario})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900 font-mono",children:u(e.cpfDestinatario)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900 font-mono",children:x(e.cnpjRemetente)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900 font-mono",children:e.numeroOperacional||"-"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:f(e)}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.tracking?.ultimaAtualizacao||h(e.dataEmissao||"")})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,r.jsx)("button",{onClick:()=>g(e,t),disabled:e.isLoadingTracking,className:"text-blue-600 hover:text-blue-900 disabled:opacity-50 disabled:cursor-not-allowed",children:e.isLoadingTracking?"Consultando...":"Consultar"})})]},e.id||t))})]})})}),(0,r.jsxs)("div",{className:"mt-6 flex justify-between items-center text-sm text-gray-500",children:[(0,r.jsxs)("p",{children:["Mostrando ",b.length," de ",e.length," remessa",1!==e.length?"s":"",n&&(0,r.jsxs)("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:["Filtro: ","emTransito"===n?"Em Tr\xe2nsito":"entregue"===n?"Entregue":"comProblemas"===n?"Com Problemas":n]})]}),(0,r.jsx)("p",{children:"\uD83D\uDCBE Dados salvos localmente - Remessas entregues s\xe3o removidas ap\xf3s 7 dias"})]})]})}function i({remessas:e,filtroAtivo:t,onFiltroChange:s}){let a=new Date,n=0,o=e.reduce((e,t)=>{if(t.tracking?.status.toLowerCase().includes("entregue")){let s=new Date(t.tracking.ultimaAtualizacao),r=Math.floor((a.getTime()-s.getTime())/864e5);r>=5&&r<=7&&n++,e.entregue++}else t.tracking?.status.toLowerCase().includes("problema")||t.tracking?.status.toLowerCase().includes("erro")?e.comProblemas++:t.tracking?e.emTransito++:e.pendentes=(e.pendentes||0)+1;return e},{emTransito:0,entregue:0,comProblemas:0,pendentes:0}),i=e=>{t===e?s(null):s(e)},l=[{id:"emTransito",title:"Em Tr\xe2nsito",value:o.emTransito,subtitle:"Remessas em movimento",icon:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),color:"bg-blue-500",bgColor:"bg-blue-50",textColor:"text-blue-600",hoverColor:"hover:bg-blue-100",activeColor:"ring-blue-500"},{id:"entregue",title:"Entregue",value:o.entregue,subtitle:n>0?`${n} expira(m) em breve`:"Entregas conclu\xeddas",icon:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),color:"bg-green-500",bgColor:"bg-green-50",textColor:"text-green-600",hoverColor:"hover:bg-green-100",activeColor:"ring-green-500"},{id:"comProblemas",title:"Com Problemas",value:o.comProblemas,subtitle:"Requer aten\xe7\xe3o",icon:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})}),color:"bg-red-500",bgColor:"bg-red-50",textColor:"text-red-600",hoverColor:"hover:bg-red-100",activeColor:"ring-red-500"}];return(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:l.map(e=>{let s=t===e.id;return(0,r.jsxs)("div",{onClick:()=>i(e.id),className:`
                ${e.bgColor} rounded-lg p-6 cursor-pointer transition-all duration-200 
                ${e.hoverColor} transform hover:scale-105 hover:shadow-md
                ${s?`ring-2 ${e.activeColor} shadow-lg scale-105`:""}
              `,children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:`flex-shrink-0 p-3 rounded-lg ${e.color}`,children:(0,r.jsx)("div",{className:"text-white",children:e.icon})}),(0,r.jsxs)("div",{className:"ml-4 flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:e.title}),s&&(0,r.jsx)("div",{className:"text-xs bg-white px-2 py-1 rounded-full text-gray-600 font-medium",children:"Filtro ativo"})]}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.value}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.subtitle})]})]}),(0,r.jsxs)("div",{className:"mt-3 text-xs text-gray-400 flex items-center",children:[(0,r.jsxs)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Clique para filtrar"]})]},e.id)})}),t&&(0,r.jsx)("div",{className:"mt-4 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"bg-white px-4 py-2 rounded-full shadow-sm border flex items-center space-x-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"})}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:["Filtro ativo: ",(0,r.jsx)("strong",{children:l.find(e=>e.id===t)?.title})]}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),s(null)},className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]})}let l="jadlog_remessas";function d(){let{remessas:e,isLoading:t,adicionarRemessas:s,atualizarRemessa:d,limparRemessas:c,limparRemessasAntigas:m,obterEstatisticas:u}=function(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0),n=e=>{try{localStorage.setItem(l,JSON.stringify(e)),t(e)}catch(e){console.error("Erro ao salvar remessas no localStorage:",e)}};return{remessas:e,isLoading:s,adicionarRemessas:t=>{let s=[...e];t.forEach(e=>{s.some(t=>t.numeroOperacional===e.numeroOperacional)||s.push(e)}),n(s)},atualizarRemessa:(t,s)=>{let r=[...e];r[t]=s,n(r)},limparRemessas:()=>{try{localStorage.removeItem(l),t([])}catch(e){console.error("Erro ao limpar remessas:",e)}},limparRemessasAntigas:()=>{let t=new Date,s=e.filter(e=>{if(e.tracking?.status.toLowerCase().includes("entregue")){let s=new Date(e.tracking.ultimaAtualizacao);return 7>=Math.floor((t.getTime()-s.getTime())/864e5)}return!0});return n(s),e.length-s.length},obterEstatisticas:()=>{let t=new Date,s=0;return{...e.reduce((e,r)=>{if(r.tracking?.status.toLowerCase().includes("entregue")){let a=new Date(r.tracking.ultimaAtualizacao);Math.floor((t.getTime()-a.getTime())/864e5)>=5&&s++,e.entregue++}else r.tracking?.status.toLowerCase().includes("problema")||r.tracking?.status.toLowerCase().includes("erro")?e.comProblemas++:e.emTransito++;return e},{emTransito:0,entregue:0,comProblemas:0}),proximasAExpirar:s}}}}(),[x,h]=(0,a.useState)(null),p=e=>{s(e)};return t?(0,r.jsx)("main",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Carregando remessas salvas..."})]})}):(0,r.jsx)("main",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center mr-3",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard de Rastreamento Jadlog"})]}),e.length>0&&(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>{let e=m();e>0?alert(`${e} remessa${e>1?"s":""} entregue${e>1?"s":""} h\xe1 mais de 7 dias foi${e>1?"ram":""} removida${e>1?"s":""} do dashboard.`):alert("Nenhuma remessa antiga foi encontrada para remo\xe7\xe3o.")},className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Limpar Antigas"}),(0,r.jsxs)("span",{className:"text-sm text-gray-500 self-center",children:["Total: ",e.length," remessas"]})]})]}),0===e.length&&(0,r.jsxs)("div",{className:"mb-12",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Importe seus arquivos XML"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Carregue os arquivos XML da Jadlog para visualizar as informa\xe7\xf5es das remessas"}),(0,r.jsx)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,r.jsx)("strong",{children:"\uD83D\uDCBE Banco de Dados Local:"})," Suas remessas ficam salvas no navegador. Remessas entregues s\xe3o automaticamente removidas ap\xf3s 7 dias."]})})]}),(0,r.jsx)(n,{onUpload:p})]}),e.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i,{remessas:e,filtroAtivo:x,onFiltroChange:h}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Adicionar mais remessas"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Carregue arquivos XML adicionais - duplicatas s\xe3o ignoradas automaticamente"})]}),(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(n,{onUpload:p,compact:!0})})]})})}),(0,r.jsx)(o,{remessas:e,onClear:()=>{window.confirm("⚠️ ATEN\xc7\xc3O: Esta a\xe7\xe3o ir\xe1 remover TODAS as remessas permanentemente!\n\nVoc\xea tem certeza que deseja continuar?\n\nEsta a\xe7\xe3o n\xe3o pode ser desfeita.")&&window.confirm("\uD83D\uDEA8 CONFIRMA\xc7\xc3O FINAL\n\nVoc\xea est\xe1 prestes a apagar TODAS as remessas do sistema.\n\nClique em OK para confirmar a exclus\xe3o definitiva.")&&(c(),h(null))},onUpdateRemessa:(e,t)=>{d(e,t)},filtroAtivo:x})]}),0===e.length&&(0,r.jsx)("div",{className:"max-w-3xl mx-auto mt-16",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Como usar esta ferramenta"}),(0,r.jsxs)("div",{className:"space-y-4 text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:"1"}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Selecione os arquivos XML:"})," Clique no bot\xe3o de upload acima e selecione um ou mais arquivos XML fornecidos pela Jadlog. Os dados ficam salvos permanentemente."]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:"2"}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Consulte o tracking:"}),' Clique em "Consultar" para obter o status atualizado via API da Jadlog. O status fica salvo e atualiza as estat\xedsticas.']})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:"3"}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Limpeza autom\xe1tica:"}),' Remessas entregues s\xe3o automaticamente removidas ap\xf3s 7 dias. Use "Limpar Antigas" para for\xe7ar a limpeza.']})]})]})]})})]})})}},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1043:(e,t,s)=>{Promise.resolve().then(s.bind(s,826))},1135:()=>{},1204:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\andre\\\\Desktop\\\\dashboard-jadlog-tracking-main\\\\src\\\\app\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\andre\\Desktop\\dashboard-jadlog-tracking-main\\src\\app\\page.tsx","default")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4413:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d});var r=s(5239),a=s(8088),n=s(8170),o=s.n(n),i=s(893),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);s.d(t,l);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1204)),"C:\\Users\\andre\\Desktop\\dashboard-jadlog-tracking-main\\src\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,4431)),"C:\\Users\\andre\\Desktop\\dashboard-jadlog-tracking-main\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,5284,23)),"next/dist/client/components/unauthorized-error"]}],c=["C:\\Users\\andre\\Desktop\\dashboard-jadlog-tracking-main\\src\\app\\page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4431:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i,metadata:()=>o});var r=s(7413),a=s(5041),n=s.n(a);s(1135);let o={title:"Rastreamento Jadlog - Gerenciador de Encomendas",description:"Aplica\xe7\xe3o para rastreamento e gerenciamento de encomendas da Jadlog"};function i({children:e}){return(0,r.jsx)("html",{lang:"pt-BR",children:(0,r.jsx)("body",{className:n().className,children:e})})}},4745:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,6346,23)),Promise.resolve().then(s.t.bind(s,7924,23)),Promise.resolve().then(s.t.bind(s,5656,23)),Promise.resolve().then(s.t.bind(s,99,23)),Promise.resolve().then(s.t.bind(s,8243,23)),Promise.resolve().then(s.t.bind(s,8827,23)),Promise.resolve().then(s.t.bind(s,2763,23)),Promise.resolve().then(s.t.bind(s,7173,23))},6579:()=>{},7899:(e,t,s)=>{Promise.resolve().then(s.bind(s,1204))},8297:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,6444,23)),Promise.resolve().then(s.t.bind(s,6042,23)),Promise.resolve().then(s.t.bind(s,8170,23)),Promise.resolve().then(s.t.bind(s,9477,23)),Promise.resolve().then(s.t.bind(s,9345,23)),Promise.resolve().then(s.t.bind(s,2089,23)),Promise.resolve().then(s.t.bind(s,6577,23)),Promise.resolve().then(s.t.bind(s,1307,23))},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[447,945],()=>s(4413));module.exports=r})();